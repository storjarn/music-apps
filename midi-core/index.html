<script src="../bower/ee-class/dist/Class.min.js"></script>
<script src="../bower/ee-class/dist/Namespace.min.js"></script>
<script src="../bower/ee-class/dist/EventEmitter.min.js"></script>
<script src="../bower/d3/d3.min.js"></script>
<script src="./lib/MIDI.js"></script>
<script src="./lib/Constants.js"></script>
<script src="./lib/Clock.js"></script>
<script src="./lib/Track.js"></script>
<script src="../music-ui/lib/Grid.js"></script>
<script>
    window.addEventListener('load', function() {
        MIDI.initialize(function() {
            var ddMidiInputs = document.getElementById("midiInputs");
            for ( var i = 0; i < MIDI.inputs.length; ++i) {
                // input.value.onmidimessage = MIDIMessageEventHandler;
                haveAtLeastOneDevice = true;
                var option = document.createElement("option");
                option.value = MIDI.inputs[i].id;
                option.text = MIDI.inputs[i].name;
                ddMidiInputs.appendChild(option);
            }
        });

        // var clock = new MIDI.Clock();
        // clock.setTempo(20);
        // var now = new Date().getTime();
        // clock.on('tick', function(tickCount){
        //     if (tickCount % 24 === 0){
        //         console.log('Beat,', new Date().getTime() - now, 'ms long');
        //         now = new Date().getTime();
        //     }
        // });

        var clock = new MIDI.Clock();
        var now = new Date().getTime();
        clock.on('clock', function(clockMessage, clock){
            if (clock.State.tickCount % 24 === 0){
                console.log('Beat,', new Date().getTime() - now, 'ms long');
                now = new Date().getTime();
            }
        });
    });
</script>

<div id="app">
    <div>MIDI Inputs</div>
    <select id="midiInputs"></select>
    <div id="pianoRoll">
    </div>
</div>

<style>
svg {
    font: 10px sans-serif;
}
.grid .tick {
    stroke: lightgrey;
    opacity: 0.7;
}
.grid path {
    stroke-width: 0;
}
.axis {
    shape-rendering: crispEdges;
}
.axis line {
    fill: none;
    shape-rendering: crispEdges;
}
.y.axis line, .y.axis path {
    fill: none;
    stroke: lightgrey;
}
</style>
